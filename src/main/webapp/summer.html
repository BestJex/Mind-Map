<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>

<link href="css/bootstrap.css" rel="stylesheet">
<link href="summernote/dist/summernote.css" rel="stylesheet">

<script type="text/javascript" src="js/jquery.min2.1.4.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="summernote/dist/summernote.js"></script>
<script src="summernote/dist/lang/summernote-zh-CN.js"></script>    <!-- 中文-->

<style>
.tags{
  width: 90%;
  background: #f5f5f5;
  margin: 0 auto;
}
</style>

</head>
<body>

     <form class="knowlegMap">
     <div class="form-group" >
        <label for="" style = "margin-left: 5%;">知识点名称</label>
        <input type="email" class="form-control" id="zsdmc" placeholder="知识点名称" style="width:90%; margin:0 auto; margin-top: 1%;">
     </div>
     <div class="tags">
       <ul class="nav nav-pills nav-justified" style="width:80%;">
	     <li role="presentation" class="active">
	       <a onclick="getzsd()">知识点描述</a>
	     </li>
	     <li role="presentation">
	       <a onclick="getUpload()">我的文件</a>
	     </li>
	     <li role="presentation">
	       <a href="#">文件收藏</a>
	     </li>
	     <li role="presentation">
	       <a href="#">文件分享</a>
	     </li>
	     <li role="presentation">
	       <a href="#">上传文件</a>
	     </li>
	 </ul>
	 </div>
     <div style="width:90%; margin:0 auto;">
        <div  class="summernote" id="a_content" name="a_content"></div>
     </div>
     </form>                  <!-- 显示加载模态框的界面 -->

     <div id="latte"></div>   <!-- 加载显示知识点时的按钮 -->
 
 
   <!-- 初始界面加载 -->
   <script type="text/javascript">
   
	   $(function(){
		   
		    getzsd();
	
	   });
   
   </script>
 
 
      <!-- 获取并显示知识点内容 -->
	  <script>
	 
	    <!-- 获取并显示知识点内容 -->
	    function getzsd(){
			  
	    	$('#a_content').summernote({
		          height: 280,
		          tabsize: 2,
		          minHeight: 20,
		          maxHeight: 900,
		          lang: 'zh-CN'
		      });            /* 加载模态框配置 */
	    	
			  var html="";
			  var button = "";
			  var nodeid=parent.get_selected_nodeid();
			  var nodeName=parent.get_selected_nodeName();
			  var adata={"nodeid":nodeid};
			  var data=JSON.stringify(adata);
			  
			     $.ajax({
			    	 type:"POST",
			    	 contentType:"application/json",
			    	 dataType:"json",
			    	 data:data,
			    	 url:"getZsd.do",
			    	 
			    	 success:function(data){
			    		 
			    		 if(data.map.zsdmc == undefined || data.map.zsdmc == null){
			    			 $("#zsdmc").attr("placeholder",nodeName);
			    		 } else{
			    			 $("#zsdmc").attr("value",data.map.zsdmc);
			    		 }
			    		 
				 		 if(data.map.zsdms == undefined){
				 			html = "请添加知识描述";
				 			$('.summernote').summernote('code',html);
				 		 } else{
				 			html = data.map.zsdms;
				 			$('.summernote').summernote('code',html);
				 		 }
				 		 
				 		 button += "<button type='button' onclick='savezsd()' class='btn btn-primary btn-lg' style='display: block; margin: 0 auto;'>保存</button>";
			    	     $("#latte").html(button);
			    	 },
			    	 
			    	 error:function(e){
			    		 alert("连接显示知识点失败");
			    	 },
			    	 
			     });
			  
		   }
	    
	    
	      <!-- 保存节点上的知识点  -->
		  function savezsd(){
			  var nodeid=parent.get_selected_nodeid();
			  var adata={"zsdid":nodeid,
						 "zsdmc":$("#zsdmc").val(),
				         "zsdms":$('#a_content').summernote('code')
				        };
			  var data=JSON.stringify(adata);
			  
			  $.ajax({
		    	  type:"POST",
		    	  contentType:"application/json",
		    	  dataType:"json",
		    	  data:data,
		    	  url:"saveZsd.do",
		    	  
		    	  success:function(data){
		    		  if(data.a=="1"){
		    			  alert("修改知识点知识成功");
		    			  window.location.reload("biji.html");
		    		  }else if(data.a=="2"){
		    			  alert("修改知识点知识失败");
		    			  window.location.reload("biji.html");
		    		  } else if(data.a=="3"){
		    			  alert("不是您的知识图谱");
		    			  window.location.reload("biji.html");
		    		  }
		    		  
		    	  },
		  
		    	  error:function(r){
		    		  alert("连接失败");
		    	  }, 
		  
		      });  
			  
		  }	    
	    
	    
	  </script>
	  
	  
	  <!-- 获取或者删除上传文件(对上传文件的操作)-->
	  <script type="text/javascript">
	  
	     //获取节点上的上传文件
	     function getUpload(){
	    	 
	    	var nodeid = parent.get_selected_nodeid();
	    	var html = "";
	    	var da={"nodeid":nodeid};
	    	
	    	   $.ajax({
	    		   type : "POST",
				   url : "getUploadfile.do",
				   data : da,
				   
				   success: function(data){
					   $('#a_content').summernote('destroy');
					   $("#latte").html("");
					   $('#a_content').html("ss");
					   /* var json = $.parseJSON(data);
					   
					   if(json.state=='0'){
						
						   $.each(json.list2,function(){
							  
							   html +="";
							  						   
						   });
						   
						   
					   } */
					   
				   },
				   
				   
	    	   });
	    	 
	    	 
	     }
	  
	  
	  
	  </script>
  
  
  
  
  





</body>
</html>