<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>

<link href="css/bootstrap.css" rel="stylesheet">
<link href="summernote/dist/summernote.css" rel="stylesheet">
<link rel="stylesheet" href="/assets/css/font-awesome.min.css" />
<link rel="stylesheet" href="/ifont/css/font-awesome.min.css" />

<script type="text/javascript" src="js/jquery.min2.1.4.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="summernote/dist/summernote.js"></script>
<script src="summernote/dist/lang/summernote-zh-CN.js"></script>    <!-- 中文-->
<script src="js/pdf.js"></script>

<style>
.tags{
  width: 90%;
  background: #f5f5f5;
  margin: 0 auto;
}
</style>

</head>
<body>

     <form class="knowlegMap">
     <div class="form-group" >
        <label for="" style = "margin-left: 5%;">知识点名称</label>
        <input type="email" class="form-control" id="zsdmc" placeholder="知识点名称" style="width:90%; margin:0 auto; margin-top: 1%;">
     </div>
     <div class="tags">
       <ul class="nav nav-pills nav-justified" style="width:80%;">
	     <li role="presentation" id="zsdms">
	       <a onclick="getzsd()">知识点描述</a>
	     </li>
	     <li role="presentation" id="myFile">
	       <a onclick="getUpload()">我的文件</a>
	     </li>
	     <li role="presentation" id="myCollect">
	       <a href="#">文件收藏</a>
	     </li>
	     <li role="presentation" id="myShare">
	       <a href="#">文件分享</a>
	     </li>
	     <li role="presentation" id="UploadFile">
	       <a href="#">上传文件</a>
	     </li>
	 </ul>
	 </div>
     <div style="width:90%; margin:0 auto;">
        <div  class="summernote" id="a_content" name="a_content"></div>
     </div>
     </form>                  <!-- 显示加载模态框的界面 -->

     <div id="latte"></div>   <!-- 加载显示知识点时的按钮 -->
 
 
   <!-- 初始界面加载 -->
   <script type="text/javascript">
   
	   $(function(){
		   
		    getzsd();
	
	   });
   
   </script>
 
 
      <!-- 获取并显示知识点内容 -->
	  <script>
	 
	    <!-- 获取并显示知识点内容 -->
	    function getzsd(){
			  
	    	$('#a_content').summernote({
		          height: 280,
		          tabsize: 2,
		          minHeight: 20,
		          maxHeight: 900,
		          lang: 'zh-CN'
		      });            /* 加载模态框配置 */
		      
			  var html="";
			  var button = "";
			  var nodeid=parent.get_selected_nodeid();
			  var nodeName=parent.get_selected_nodeName();
			  var adata={"nodeid":nodeid};
			  var data=JSON.stringify(adata);
			  $("li").removeClass("active");
			  $("#zsdms").addClass("active");
			  
			     $.ajax({
			    	 type:"POST",
			    	 contentType:"application/json",
			    	 dataType:"json",
			    	 data:data,
			    	 url:"getZsd.do",
			    	 
			    	 success:function(data){
			    		 
			    		 if(data.map.zsdmc == undefined || data.map.zsdmc == null){
			    			 $("#zsdmc").attr("placeholder",nodeName);
			    		 } else{
			    			 $("#zsdmc").attr("value",data.map.zsdmc);
			    		 }
			    		 
				 		 if(data.map.zsdms == undefined){
				 			html = "请添加知识描述";
				 			$('.summernote').summernote('code',html);
				 		 } else{
				 			html = data.map.zsdms;
				 			$('.summernote').summernote('code',html);
				 		 }
				 		 
				 		 button += "<button type='button' onclick='savezsd()' class='btn btn-primary btn-lg' style='display: block; margin: 0 auto;'>保存</button>";
			    	     $("#latte").html(button);
			    	 },
			    	 
			    	 error:function(e){
			    		 alert("连接显示知识点失败");
			    	 },
			    	 
			     });
			  
		   }
	    
	    
	      <!-- 保存节点上的知识点  -->
		  function savezsd(){
			  var nodeid=parent.get_selected_nodeid();
			  var adata={"zsdid":nodeid,
						 "zsdmc":$("#zsdmc").val(),
				         "zsdms":$('#a_content').summernote('code')
				        };
			  var data=JSON.stringify(adata);
			  
			  $.ajax({
		    	  type:"POST",
		    	  contentType:"application/json",
		    	  dataType:"json",
		    	  data:data,
		    	  url:"saveZsd.do",
		    	  
		    	  success:function(data){
		    		  if(data.a=="1"){
		    			  alert("修改知识点知识成功");
		    			  window.location.reload("biji.html");
		    		  }else if(data.a=="2"){
		    			  alert("修改知识点知识失败");
		    			  window.location.reload("biji.html");
		    		  } else if(data.a=="3"){
		    			  alert("不是您的知识图谱");
		    			  window.location.reload("biji.html");
		    		  }
		    		  
		    	  },
		  
		    	  error:function(r){
		    		  alert("连接失败");
		    	  }, 
		  
		      });  
			  
		  }	    
	    
	    
	  </script>
	  
	  
	  <!-- 获取或者删除上传文件(对上传文件的操作)-->
	  <script type="text/javascript">
	  
	     //获取节点上的上传文件
	     function getUpload(){
	    	 
	    	var nodeid = parent.get_selected_nodeid();
	    	var html = "";
	    	var da={"nodeid":nodeid};
	    	
	    	
	    	   $.ajax({
	    		   type : "POST",
				   url : "getUploadfile.do",
				   data : da,
				   
				   success: function(data){
					   $('#a_content').summernote('destroy');
					   $("#latte").html("");
					   $("li").removeClass("active");
					   $("#myFile").addClass("active");
					   
					   var json = $.parseJSON(data);
					   
					   //html += "</br></br></br></br></br></br><h1 align='center'>暂无上传文件</h1>";
					   html += "<div><div><div><div><img class='img-circle' src='images/laba.jpg'/>"
				                   +"<a class='user'> newbee </a><span style='float:right'><i class='icon-time bigger-110'></i>&nbsp;2018</span><div class='time'><i class='icon-time bigger-110'></i>&nbsp;pic1</div></div>"+
				                   "<div class='tools action-buttons'><a class='blue'><i class='icon-eye-open bigger-125'></i></a>&nbsp;<a class='red'><i class='icon-remove bigger-125'></i></a></div></div></div></div>"; 
					   $("#a_content").html(html);
					   
					   if(json.state=='0'){
						   
						   $.each(json.list2,function(){
							   
							   html +="<div>";
							  						   
						   });
						   
						   
					   } 
					   
				   },
				   
				   
	    	   });
	    	 
	    	 
	     }
	  
	  
	  
	  </script>
  
  
  
  
  





</body>
</html>